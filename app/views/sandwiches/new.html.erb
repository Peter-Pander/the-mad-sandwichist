<h1>Create a Sandwich</h1>

<% if @sandwich.errors.any? %>
  <div class="alert alert-danger">
    <h4>There were some errors with your submission:</h4>
    <ul>
      <% @sandwich.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
    </ul>
  </div>
<% end %>

<%= simple_form_for @sandwich do |f| %>
  <div class="mb-3">
    <%= f.input :name, label: "Sandwich Name", input_html: { class: 'form-control' } %>
  </div>

  <div class="mb-3">
    <h3>Select Ingredients:</h3>
    <% @ingredients.each do |ingredient| %>
      <div>
        <!-- If image_url contains the Cloudinary ID, use Cloudinary::Utils to generate the full URL -->
        <%= image_tag(Cloudinary::Utils.cloudinary_url(ingredient.image_url), alt: ingredient.name, width: "100", height: "100") if ingredient.image_url.present? %>
        <%= label_tag "ingredient_#{ingredient.id}" do %>
          <%= check_box_tag "sandwich[ingredient_ids][]", ingredient.id, @sandwich.ingredient_ids.include?(ingredient.id), id: "ingredient_#{ingredient.id}", class: 'form-check-input' %>
          <%= ingredient.name %>
        <% end %>
      </div>
    <% end %>
  </div>

  <div class="mb-3">
    <%= f.submit "Create Sandwich", class: "btn btn-primary" %>
  </div>
<% end %>

<div class="mt-3">
  <%= link_to "Back", root_path, class: "btn btn-secondary" %>
</div>
